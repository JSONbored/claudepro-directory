/**
 * Sugar High Syntax Highlighting Styles - Production Ready Design
 * WCAG AAA/AA compliant matching enhanced mockup design (Nov 2025)
 * Exact colors from comprehensive specification
 * @see https://github.com/huozhi/sugar-high
 */

/* Sugar High CSS Variables - Dark Mode (WCAG AAA: 19:1+ contrast)
   These map directly to Sugar High's inline color variables */
:root {
  /* Core Sugar High variables that the library uses */
  --sh-class: #a78bfa; /* Purple for classes/constructors */
  --sh-identifier: #abd5ff; /* Light blue for variables/identifiers */
  --sh-sign: #89ddff; /* Bright cyan for operators/punctuation - make them pop */
  --sh-string: #d4bf8f; /* Muted gold for strings */
  --sh-keyword: #c792ea; /* Purple for keywords/booleans/numbers */
  --sh-comment: #6b7280; /* Medium gray for comments */
  --sh-jsxliterals: #abd5ff; /* Light blue for JSX */
  --sh-property: #abd5ff; /* Light blue for object properties */
  --sh-entity: #ffcb6b; /* Yellow for entities */

  /* Code block structure colors - Dark mode */
  --code-bg: oklch(20% 0.005 60); /* #1a1a1a - matches spec */
  --code-border: oklch(25% 0.005 60); /* #3a3a3a - more visible border */
  --code-inner-glow: oklch(22% 0.005 60); /* #252525 - inner glow layer */
  --code-header-bg: rgba(255, 255, 255, 0.03);
  --code-line-number: #6b7280; /* Much brighter gray - highly visible */

  /* UI colors - Dark mode */
  --code-badge-bg: oklch(74% 0.2 35); /* #F59E0B - Claude orange */
  --code-line-highlight-bg: oklch(22% 0.01 60); /* #1f1f1f */
  --code-line-highlight-border: oklch(74% 0.2 35); /* #F59E0B - orange accent */
}

/* Light Theme Overrides - WCAG AA (7:1+ contrast) */
@media (prefers-color-scheme: light) {
  :root {
    /* Core Sugar High variables - Light Mode */
    --sh-class: #7c3aed; /* Deep purple */
    --sh-identifier: #0284c7; /* Deep sky blue */
    --sh-sign: #dc2626; /* Red */
    --sh-string: #059669; /* Forest green */
    --sh-keyword: #d97706; /* Deep amber */
    --sh-comment: #6b7280; /* Medium gray */
    --sh-jsxliterals: #0284c7; /* Blue */
    --sh-property: #0284c7; /* Deep sky blue */
    --sh-entity: #d97706; /* Amber */

    /* Code block structure colors - Light mode */
    --code-bg: oklch(98% 0.004 85); /* #FEFEFE */
    --code-border: oklch(84% 0.005 85); /* #d0d0d0 */
    --code-inner-glow: oklch(95% 0.004 85); /* #f0f0f0 */
    --code-header-bg: rgba(0, 0, 0, 0.03);
    --code-line-number: oklch(60% 0.01 260); /* #9CA3AF */

    /* UI colors - Light mode */
    --code-badge-bg: oklch(58% 0.18 35); /* #D97706 - darker orange */
    --code-line-highlight-bg: oklch(96% 0.05 55); /* #FEF3C7 - light yellow tint */
    --code-line-highlight-border: oklch(58% 0.18 35); /* #D97706 */
  }
}

/* Forced Dark Mode */
[data-theme="dark"] {
  --sh-class: #a78bfa;
  --sh-identifier: #abd5ff;
  --sh-sign: #89ddff; /* Bright cyan for brackets/colons */
  --sh-string: #d4bf8f; /* Muted gold - matches :root */
  --sh-keyword: #c792ea;
  --sh-comment: #6b7280;
  --sh-jsxliterals: #abd5ff;
  --sh-property: #abd5ff;
  --sh-entity: #ffcb6b;
  --code-bg: oklch(20% 0.005 60);
  --code-border: oklch(25% 0.005 60);
  --code-inner-glow: oklch(22% 0.005 60);
  --code-line-number: oklch(32% 0.01 260);
  --code-badge-bg: oklch(74% 0.2 35);
  --code-line-highlight-bg: oklch(22% 0.01 60);
  --code-line-highlight-border: oklch(74% 0.2 35);
}

/* Forced Light Mode */
[data-theme="light"] {
  --sh-class: #7c3aed;
  --sh-identifier: #0284c7;
  --sh-sign: #dc2626;
  --sh-string: #059669;
  --sh-keyword: #d97706;
  --sh-comment: #6b7280;
  --sh-jsxliterals: #0284c7;
  --sh-property: #0284c7;
  --sh-entity: #d97706;
  --code-bg: oklch(98% 0.004 85);
  --code-border: oklch(84% 0.005 85);
  --code-inner-glow: oklch(95% 0.004 85);
  --code-line-number: oklch(60% 0.01 260);
  --code-badge-bg: oklch(58% 0.18 35);
  --code-line-highlight-bg: oklch(96% 0.05 55);
  --code-line-highlight-border: oklch(58% 0.18 35);
}

/* Code Block Wrapper - Enhanced 4-Layer Shadow System */
.code-block-wrapper {
  position: relative;
  margin: 1.5rem 0;
  border-radius: 8px;
  overflow: hidden;
  background: var(--code-bg);
  border: 1px solid var(--code-border);

  /* 4-Layer Shadow System for depth (Dark Mode) */
  box-shadow:
    0 0 0 1px var(--code-inner-glow), /* Layer 1: Inner glow */
    0 2px 4px rgba(0, 0, 0, 0.08), /* Layer 2: Base shadow */
    0 4px 8px rgba(0, 0, 0, 0.06), /* Layer 3: Structure shadow */
    0 8px 16px rgba(0, 0, 0, 0.04); /* Layer 4: Atmosphere shadow */
}

@media (prefers-color-scheme: light) {
  .code-block-wrapper {
    /* Subtle shadows for light mode */
    box-shadow:
      0 0 0 1px var(--code-inner-glow),
      0 1px 3px rgba(0, 0, 0, 0.06),
      0 4px 6px rgba(0, 0, 0, 0.04);
  }
}

[data-theme="dark"] .code-block-wrapper {
  box-shadow:
    0 0 0 1px var(--code-inner-glow),
    0 2px 4px rgba(0, 0, 0, 0.08),
    0 4px 8px rgba(0, 0, 0, 0.06),
    0 8px 16px rgba(0, 0, 0, 0.04);
}

[data-theme="light"] .code-block-wrapper {
  box-shadow:
    0 0 0 1px var(--code-inner-glow),
    0 1px 3px rgba(0, 0, 0, 0.06),
    0 4px 6px rgba(0, 0, 0, 0.04);
}

/* Code Block Header - Enhanced Design */
.code-block-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  min-height: 48px;
  background: var(--code-header-bg);
  border-bottom: 1px solid var(--code-border);
}

.code-block-header-left {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.code-block-filename {
  font-family: var(--font-mono, "JetBrains Mono", "Monaco", monospace);
  font-size: 0.875rem;
  font-weight: 500;
  color: oklch(60% 0.01 260); /* #9CA3AF - muted */
}

/* Language Badge - Glassmorphic Design */
.code-block-language {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.025em;

  /* Dark Mode Badge - Glassmorphic */
  background: linear-gradient(135deg, oklch(74% 0.2 35 / 0.15), oklch(74% 0.2 35 / 0.1));
  border: 1px solid oklch(74% 0.2 35 / 0.3);
  color: var(--code-badge-bg);
  backdrop-filter: blur(4px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

@media (prefers-color-scheme: light) {
  .code-block-language {
    background: oklch(96% 0.05 55 / 0.5); /* Light amber tint */
    border: 1px solid oklch(58% 0.18 35 / 0.25);
    color: var(--code-badge-bg);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  }
}

[data-theme="dark"] .code-block-language {
  background: linear-gradient(135deg, oklch(74% 0.2 35 / 0.15), oklch(74% 0.2 35 / 0.1));
  border: 1px solid oklch(74% 0.2 35 / 0.3);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

[data-theme="light"] .code-block-language {
  background: oklch(96% 0.05 55 / 0.5);
  border: 1px solid oklch(58% 0.18 35 / 0.25);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.code-block-header-actions {
  display: flex;
  align-items: center;
  gap: 6px;
}

/* Action Buttons - Enhanced Hover States */
.code-action-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid transparent;
  border-radius: 6px;
  background: transparent;
  color: oklch(60% 0.01 260); /* #9CA3AF */
  cursor: pointer;
  transition: all 0.15s ease;
}

/* Dark Mode Button Hover */
.code-action-btn:hover {
  background: oklch(22% 0.01 60 / 0.5); /* #1f1f1f */
  border-color: oklch(28% 0.01 60); /* #2f2f2f */
  color: oklch(90% 0.01 260); /* #E5E7EB */
}

/* Light Mode Button Hover */
@media (prefers-color-scheme: light) {
  .code-action-btn:hover {
    background: oklch(94% 0.004 260); /* #E5E7EB */
    border-color: oklch(84% 0.005 85); /* #d0d0d0 */
    color: oklch(42% 0.05 260); /* #4B5563 */
  }
}

[data-theme="dark"] .code-action-btn:hover {
  background: oklch(22% 0.01 60 / 0.5);
  border-color: oklch(28% 0.01 60);
  color: oklch(90% 0.01 260);
}

[data-theme="light"] .code-action-btn:hover {
  background: oklch(94% 0.004 260);
  border-color: oklch(84% 0.005 85);
  color: oklch(42% 0.05 260);
}

/* Success State (after copy) */
.code-action-btn:active,
.code-action-btn.success {
  background: oklch(45% 0.18 160 / 0.1); /* Green tint */
  border-color: oklch(45% 0.18 160 / 0.3);
  color: oklch(55% 0.18 160); /* #10B981 */
  transform: scale(1.05);
}

/* Code Block Pre/Code - Ultra-Compact Typography */
.code-block-pre {
  margin: 0;
  padding: 1rem 0;
  overflow-x: auto;
  background: var(--code-bg);
  font-family: "JetBrains Mono", "Fira Code", Consolas, Monaco, monospace;
  font-size: 0.8125rem; /* 13px */
  line-height: 0.75; /* Ultra-tight 0.75 line spacing */
}

/* Custom Scrollbar - Dark Mode */
.code-block-pre::-webkit-scrollbar {
  height: 10px;
}

.code-block-pre::-webkit-scrollbar-track {
  background: transparent;
}

.code-block-pre::-webkit-scrollbar-thumb {
  background: linear-gradient(to bottom, oklch(48% 0.01 260), oklch(42% 0.01 260));
  border-radius: 5px;
}

.code-block-pre::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(to bottom, oklch(55% 0.01 260), oklch(48% 0.01 260));
}

/* Custom Scrollbar - Light Mode */
@media (prefers-color-scheme: light) {
  .code-block-pre::-webkit-scrollbar-thumb {
    background: oklch(82% 0.005 260); /* #D1D5DB */
    border-radius: 5px;
  }

  .code-block-pre::-webkit-scrollbar-thumb:hover {
    background: oklch(70% 0.01 260); /* #9CA3AF */
  }
}

[data-theme="dark"] .code-block-pre::-webkit-scrollbar-thumb {
  background: linear-gradient(to bottom, oklch(48% 0.01 260), oklch(42% 0.01 260));
}

[data-theme="dark"] .code-block-pre::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(to bottom, oklch(55% 0.01 260), oklch(48% 0.01 260));
}

[data-theme="light"] .code-block-pre::-webkit-scrollbar-thumb {
  background: oklch(82% 0.005 260);
}

[data-theme="light"] .code-block-pre::-webkit-scrollbar-thumb:hover {
  background: oklch(70% 0.01 260);
}

/* Base Sugar High Styles */
.sugar-high {
  display: block;
  color: var(--color-text-primary, hsl(var(--foreground)));
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  font-weight: 400;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* Token-Specific Enhancements */
.sh__token--keyword {
  font-weight: 600;
}

.sh__token--comment {
  font-style: italic;
  opacity: 0.9;
}

.sh__token--class {
  font-weight: 500;
}

/* Line Numbers - Compact Spacing */
.sugar-high > .sh__line,
code.sugar-high > .sh__line {
  display: block;
  padding: 0 1rem;
  position: relative;
}

.sh__line::before {
  content: attr(data-line);
  display: inline-block;
  width: 2rem;
  margin-right: 0; /* Zero gap - tight to code */
  text-align: right;
  color: var(--code-line-number);
  opacity: 1; /* Full opacity - was too faint at 0.5 */
  user-select: none;
  font-size: inherit;
}

/* Line Highlighting Feature - Orange Accent Border (Key Feature from Mockup) */
.sh__line--highlighted,
.sh__line[data-highlighted],
.sh__line[data-highlighted-line] {
  background: var(--code-line-highlight-bg);
  border-left: 2px solid var(--code-line-highlight-border);
  padding-left: calc(1rem - 2px); /* Adjust for border */
}

/* Light Mode Line Highlighting */
@media (prefers-color-scheme: light) {
  .sh__line--highlighted,
  .sh__line[data-highlighted],
  .sh__line[data-highlighted-line] {
    background: var(--code-line-highlight-bg);
    border-left: 2px solid var(--code-line-highlight-border);
  }
}

[data-theme="dark"] .sh__line--highlighted,
[data-theme="dark"] .sh__line[data-highlighted],
[data-theme="dark"] .sh__line[data-highlighted-line] {
  background: var(--code-line-highlight-bg);
  border-left: 2px solid var(--code-line-highlight-border);
  padding-left: calc(1rem - 2px);
}

[data-theme="light"] .sh__line--highlighted,
[data-theme="light"] .sh__line[data-highlighted],
[data-theme="light"] .sh__line[data-highlighted-line] {
  background: var(--code-line-highlight-bg);
  border-left: 2px solid var(--code-line-highlight-border);
  padding-left: calc(1rem - 2px);
}

/* Selection in code blocks */
.sugar-high ::selection {
  background-color: rgba(99, 102, 241, 0.25);
}

@media (prefers-color-scheme: light) {
  .sugar-high ::selection {
    background-color: rgba(99, 102, 241, 0.2);
  }
}

/* Empty/Fallback state */
.sugar-high-empty,
.code-block-fallback {
  padding: 1rem;
  color: var(--color-text-muted, hsl(var(--muted-foreground)));
  font-style: italic;
  background: var(--code-bg);
}

/* Mobile optimizations */
@media (max-width: 640px) {
  .code-block-pre {
    font-size: 0.75rem;
    padding: 0.75rem;
  }

  .sh__line::before {
    width: 2rem;
    margin-right: 1rem;
  }

  .code-block-header {
    padding: 0.375rem 0.75rem;
  }

  .code-block-filename {
    font-size: 0.75rem;
  }

  .code-action-btn {
    width: 1.75rem;
    height: 1.75rem;
  }

  .code-action-btn svg {
    width: 14px;
    height: 14px;
  }
}

/* React-share button wrapper styling override */
.share-button-wrapper button {
  all: unset;
  cursor: pointer;
  display: block;
  width: 100%;
}

.share-button-wrapper button:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}
