/**
 * Sugar High Syntax Highlighting Styles - Polar.sh Inspired Design
 * Clean, minimal, professional code blocks with tight line spacing
 * @see https://github.com/huozhi/sugar-high
 */

/* Sugar High CSS Variables - Dark Mode
   Polar.sh-inspired muted color palette - professional and readable */
:root {
  /* Core Sugar High variables - Polar.sh-style muted palette */
  --sh-class: #a5d6ff;      /* Soft blue - classes/constructors */
  --sh-identifier: #c9d1d9; /* GitHub-style light gray - variables/identifiers */
  --sh-sign: #8b949e;       /* Very subtle gray - punctuation */
  --sh-string: #a5d6a7;     /* Soft muted green - strings */
  --sh-keyword: #79c0ff;    /* Soft blue - keywords/booleans */
  --sh-comment: #6e7681;    /* Muted gray - comments */
  --sh-jsxliterals: #a5d6ff; /* Soft blue - JSX */
  --sh-property: #c9d1d9;   /* Same as identifier - object properties */
  --sh-entity: #f9c859;     /* Warmer yellow - entities */

  /* Code block structure colors - Polar.sh dark mode */
  --code-bg: #161b22;       /* Darker background like GitHub/Polar */
  --code-border: #30363d;   /* Subtle border */
  --code-header-bg: rgba(255, 255, 255, 0.02);
  --code-line-number: #484f58; /* More subtle line numbers */

  /* UI colors - Dark mode */
  --code-badge-color: #6e7681;
  --code-line-highlight-bg: rgba(99, 102, 241, 0.08);
  --code-line-highlight-border: #6366f1;
}

/* Light Theme Overrides - Polar-style */
@media (prefers-color-scheme: light) {
  :root {
    /* Core Sugar High variables - Light Mode (muted palette) */
    --sh-class: #6366f1;     /* Indigo */
    --sh-identifier: #1e293b; /* Slate 800 */
    --sh-sign: #64748b;       /* Slate 500 */
    --sh-string: #059669;     /* Emerald 600 */
    --sh-keyword: #0284c7;    /* Sky 600 */
    --sh-comment: #94a3b8;    /* Slate 400 */
    --sh-jsxliterals: #6366f1; /* Indigo */
    --sh-property: #1e293b;   /* Slate 800 */
    --sh-entity: #d97706;     /* Amber 600 */

    /* Code block structure colors - Light mode */
    --code-bg: #fafafa;
    --code-border: #e5e7eb;
    --code-header-bg: rgba(0, 0, 0, 0.02);
    --code-line-number: #9ca3af;

    /* UI colors - Light mode */
    --code-badge-color: #64748b;
    --code-line-highlight-bg: rgba(99, 102, 241, 0.06);
    --code-line-highlight-border: #6366f1;
  }
}

/* Forced Dark Mode - Polar.sh-style */
[data-theme="dark"] {
  --sh-class: #a5d6ff;
  --sh-identifier: #c9d1d9;
  --sh-sign: #8b949e;
  --sh-string: #a5d6a7;
  --sh-keyword: #79c0ff;
  --sh-comment: #6e7681;
  --sh-jsxliterals: #a5d6ff;
  --sh-property: #c9d1d9;
  --sh-entity: #f9c859;
  --code-bg: #161b22;
  --code-border: #30363d;
  --code-header-bg: rgba(255, 255, 255, 0.02);
  --code-line-number: #484f58;
  --code-badge-color: #6e7681;
  --code-line-highlight-bg: rgba(99, 102, 241, 0.08);
  --code-line-highlight-border: #6366f1;
}

/* Forced Light Mode - Polar-style */
[data-theme="light"] {
  --sh-class: #6366f1;
  --sh-identifier: #1e293b;
  --sh-sign: #64748b;
  --sh-string: #059669;
  --sh-keyword: #0284c7;
  --sh-comment: #94a3b8;
  --sh-jsxliterals: #6366f1;
  --sh-property: #1e293b;
  --sh-entity: #d97706;
  --code-bg: #fafafa;
  --code-border: #e5e7eb;
  --code-header-bg: rgba(0, 0, 0, 0.02);
  --code-line-number: #9ca3af;
  --code-badge-color: #64748b;
  --code-line-highlight-bg: rgba(99, 102, 241, 0.06);
  --code-line-highlight-border: #6366f1;
}

/* Code Block Wrapper - Polar-style Clean Design */
.code-block-wrapper {
  position: relative;
  margin: 1.5rem 0;
  border-radius: 8px;
  overflow: hidden;
  background: var(--code-bg);
  border: 1px solid var(--code-border);
  /* Clean, minimal - no heavy shadows */
}

/* Code Block Header - Polar-style Minimal */
.code-block-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px;
  min-height: 40px;
  background: var(--code-header-bg);
  border-bottom: 1px solid var(--code-border);
}

.code-block-header-left {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.code-block-filename {
  font-family: "GeistMono", var(--font-geist-mono), ui-monospace, monospace;
  font-size: 0.8125rem;
  font-weight: 500;
  color: #9ca3af;
}

/* Language Badge - Polar-style Plain Text */
.code-block-language {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  /* Plain, minimal styling */
  background: transparent;
  border: none;
  color: var(--code-badge-color);
}

.code-block-header-actions {
  display: flex;
  align-items: center;
  gap: 4px;
  /* Hide until hover */
  opacity: 0;
  transition: opacity 0.15s ease;
}

.code-block-wrapper:hover .code-block-header-actions {
  opacity: 1;
}

/* Action Buttons - Polar-style Minimal */
.code-action-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  padding: 0;
  border: none;
  border-radius: 4px;
  background: transparent;
  color: #6b7280;
  cursor: pointer;
  transition: all 0.15s ease;
}

.code-action-btn:hover {
  background: rgba(255, 255, 255, 0.08);
  color: #e5e7eb;
}

@media (prefers-color-scheme: light) {
  .code-action-btn:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #374151;
  }
}

[data-theme="dark"] .code-action-btn:hover {
  background: rgba(255, 255, 255, 0.08);
  color: #e5e7eb;
}

[data-theme="light"] .code-action-btn:hover {
  background: rgba(0, 0, 0, 0.05);
  color: #374151;
}

/* Success State (after copy) */
.code-action-btn.success {
  color: #10b981;
}

/* Code Block Pre/Code - Polar.sh-style Typography with tight line spacing */
.code-block-pre {
  margin: 0;
  padding: 0.75rem 0;
  overflow-x: auto;
  background: var(--code-bg);
  font-family: "GeistMono", var(--font-geist-mono), ui-monospace, "SF Mono", Consolas, monospace;
  font-size: 13px;
  line-height: 1.45; /* Tighter line spacing like Polar.sh */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Custom Scrollbar - Minimal */
.code-block-pre::-webkit-scrollbar {
  height: 8px;
}

.code-block-pre::-webkit-scrollbar-track {
  background: transparent;
}

.code-block-pre::-webkit-scrollbar-thumb {
  background: #3f3f46;
  border-radius: 4px;
}

.code-block-pre::-webkit-scrollbar-thumb:hover {
  background: #52525b;
}

@media (prefers-color-scheme: light) {
  .code-block-pre::-webkit-scrollbar-thumb {
    background: #d1d5db;
  }

  .code-block-pre::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
  }
}

[data-theme="dark"] .code-block-pre::-webkit-scrollbar-thumb {
  background: #3f3f46;
}

[data-theme="dark"] .code-block-pre::-webkit-scrollbar-thumb:hover {
  background: #52525b;
}

[data-theme="light"] .code-block-pre::-webkit-scrollbar-thumb {
  background: #d1d5db;
}

[data-theme="light"] .code-block-pre::-webkit-scrollbar-thumb:hover {
  background: #9ca3af;
}

/* Base Sugar High Styles - Polar-style */
.sugar-high {
  display: block;
  color: #e2e8f0;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  font-weight: 400;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

@media (prefers-color-scheme: light) {
  .sugar-high {
    color: #1e293b;
  }
}

[data-theme="dark"] .sugar-high {
  color: #e2e8f0;
}

[data-theme="light"] .sugar-high {
  color: #1e293b;
}

/* Token-Specific Enhancements - Polar.sh style */
.sh__token--keyword {
  font-weight: 450; /* Slightly heavier for emphasis */
}

.sh__token--comment {
  font-style: italic;
  opacity: 0.7; /* More subtle comments */
}

.sh__token--class {
  font-weight: 450;
}

.sh__token--function {
  font-weight: 450;
}

/* Line Numbers - Polar.sh-style compact spacing */
.sugar-high > .sh__line,
code.sugar-high > .sh__line {
  display: block;
  padding: 0 1rem;
  min-height: 1.45em; /* Match line-height for consistent spacing */
  position: relative;
}

.sh__line::before {
  content: attr(data-line);
  display: inline-block;
  width: 2rem;
  margin-right: 0.875rem;
  padding-right: 0.5rem;
  text-align: right;
  color: var(--code-line-number);
  user-select: none;
  font-size: 12px; /* Slightly smaller for de-emphasis */
  opacity: 0.6;    /* More subtle like Polar.sh */
  font-variant-numeric: tabular-nums;
}

/* Line Highlighting Feature - Subtle indigo accent */
.sh__line--highlighted,
.sh__line[data-highlighted],
.sh__line[data-highlighted-line] {
  background: var(--code-line-highlight-bg);
  border-left: 2px solid var(--code-line-highlight-border);
  margin-left: -2px;
}

/* Selection in code blocks */
.sugar-high ::selection {
  background-color: rgba(99, 102, 241, 0.25);
}

/* Empty/Fallback state */
.sugar-high-empty,
.code-block-fallback {
  padding: 1rem 1.25rem;
  color: #6b7280;
  font-style: italic;
  background: var(--code-bg);
}

/* Mobile optimizations */
@media (max-width: 640px) {
  .code-block-pre {
    font-size: 12px;
    padding: 0.5rem 0;
    line-height: 1.45;
  }

  .sh__line::before {
    width: 1.75rem;
    margin-right: 0.625rem;
    padding-right: 0.375rem;
    font-size: 11px;
  }

  .sugar-high > .sh__line,
  code.sugar-high > .sh__line {
    padding: 0 0.75rem;
    min-height: 1.45em;
  }

  .code-block-header {
    padding: 8px 12px;
    min-height: 36px;
  }

  .code-block-filename {
    font-size: 0.75rem;
  }

  .code-action-btn {
    width: 24px;
    height: 24px;
  }

  .code-action-btn svg {
    width: 14px;
    height: 14px;
  }

  /* Always show actions on mobile (no hover) */
  .code-block-header-actions {
    opacity: 1;
  }
}

/* React-share button wrapper styling override */
.share-button-wrapper button {
  all: unset;
  cursor: pointer;
  display: block;
  width: 100%;
}

.share-button-wrapper button:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}
