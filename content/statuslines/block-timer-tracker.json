{
  "slug": "block-timer-tracker",
  "description": "Claude 5-hour conversation block tracker with visual countdown, expiration warnings, and color-coded indicators to prevent unexpected session terminations.",
  "category": "statuslines",
  "author": "JSONbored",
  "dateAdded": "2025-10-23",
  "tags": ["timer", "session-block", "countdown", "5-hour-limit", "warnings", "productivity"],
  "statuslineType": "custom",
  "content": "#!/usr/bin/env bash\n\n# Block Timer Tracker for Claude Code\n# Monitors Claude's 5-hour conversation block limit with countdown\n\n# Read JSON from stdin\nread -r input\n\n# Extract session start time and current timestamp\nsession_start=$(echo \"$input\" | jq -r '.session.startTime // \"\"')\ncurrent_time=$(date +%s)\n\n# Calculate elapsed time in seconds\nif [ -n \"$session_start\" ]; then\n  start_epoch=$(date -j -f \"%Y-%m-%dT%H:%M:%SZ\" \"$session_start\" +%s 2>/dev/null || echo \"$current_time\")\n  elapsed=$((current_time - start_epoch))\nelse\n  elapsed=0\nfi\n\n# 5-hour block = 18000 seconds\nBLOCK_LIMIT=18000\nremaining=$((BLOCK_LIMIT - elapsed))\n\n# Convert to hours:minutes:seconds\nhours=$((remaining / 3600))\nminutes=$(((remaining % 3600) / 60))\nseconds=$((remaining % 60))\n\n# Calculate percentage remaining\nif [ $BLOCK_LIMIT -gt 0 ]; then\n  percent=$((remaining * 100 / BLOCK_LIMIT))\nelse\n  percent=0\nfi\n\n# Color codes based on time remaining\nif [ $percent -gt 50 ]; then\n  # Green: > 2.5 hours remaining\n  COLOR=\"\\033[38;5;46m\"\n  ICON=\"✓\"\nelif [ $percent -gt 20 ]; then\n  # Yellow: 1-2.5 hours remaining\n  COLOR=\"\\033[38;5;226m\"\n  ICON=\"⚠\"\nelif [ $percent -gt 0 ]; then\n  # Red: < 1 hour remaining\n  COLOR=\"\\033[38;5;196m\"\n  ICON=\"⚠\"\nelse\n  # Expired\n  COLOR=\"\\033[38;5;160m\"\n  ICON=\"✗\"\nfi\n\nRESET=\"\\033[0m\"\n\n# Progress bar (20 chars)\nbar_filled=$((percent / 5))\nbar_empty=$((20 - bar_filled))\nbar=\"\"\nfor ((i=0; i<bar_filled; i++)); do bar+=\"█\"; done\nfor ((i=0; i<bar_empty; i++)); do bar+=\"░\"; done\n\n# Format time display\nif [ $remaining -gt 0 ]; then\n  time_display=$(printf \"%dh %02dm %02ds\" $hours $minutes $seconds)\nelse\n  time_display=\"EXPIRED\"\nfi\n\n# Build statusline\necho -e \"${COLOR}${ICON} Block: [${bar}] ${time_display} (${percent}%)${RESET}\"\n\n# Warning messages (stderr for alerts)\nif [ $percent -le 10 ] && [ $percent -gt 0 ]; then\n  echo \"⚠ WARNING: Less than 30 minutes remaining in conversation block!\" >&2\nelif [ $remaining -le 0 ]; then\n  echo \"✗ BLOCK EXPIRED: Start new conversation to continue.\" >&2\nfi",
  "features": [
    "Real-time countdown from 5-hour conversation block limit",
    "Visual progress bar showing time remaining (20-character bar)",
    "Color-coded indicators: green (>50%), yellow (20-50%), red (<20%)",
    "Percentage display for quick at-a-glance assessment",
    "Automatic warnings at 10% remaining (~30 minutes)",
    "Expiration alerts when block time exceeded",
    "Time display in hours, minutes, seconds format",
    "Icons indicating block health status (✓, ⚠, ✗)"
  ],
  "configuration": {
    "format": "bash",
    "refreshInterval": 1000,
    "position": "right",
    "colorScheme": "traffic-light"
  },
  "useCases": [
    "Preventing unexpected session terminations mid-conversation",
    "Planning work sessions around 5-hour block limits",
    "Visual reminder to save context before block expiration",
    "Productivity tracking for extended Claude Code sessions",
    "Warning system for time-sensitive development tasks"
  ],
  "requirements": [
    "Bash shell",
    "jq JSON processor",
    "date command with -j flag (macOS/BSD) or -d flag (Linux)",
    "Terminal with ANSI color support"
  ],
  "preview": "✓ Block: [████████████████░░░░] 3h 42m 15s (74%)",
  "troubleshooting": [
    {
      "issue": "Time showing as 0h 00m 00s or EXPIRED immediately on start",
      "solution": "Check session.startTime exists in JSON input. Verify date parsing: date -j -f '%Y-%m-%dT%H:%M:%SZ' '2025-10-23T10:00:00Z' +%s. On Linux use -d instead of -j flag."
    },
    {
      "issue": "Progress bar showing all filled or all empty incorrectly",
      "solution": "Verify BLOCK_LIMIT=18000 (5 hours in seconds). Check percent calculation: echo $((remaining * 100 / BLOCK_LIMIT)). Ensure remaining time calculated correctly from session start."
    },
    {
      "issue": "Warning messages not appearing when time low",
      "solution": "Warnings output to stderr (>&2) for alerts. Check stderr visible in terminal. Test: bash statusline.sh 2>&1 | grep WARNING. Ensure percent calculation under 10 triggers warning."
    },
    {
      "issue": "Colors not displaying, showing escape codes instead",
      "solution": "Terminal may not support ANSI colors. Test: echo -e '\\033[38;5;46mGreen\\033[0m'. Enable color support in terminal settings. For screen/tmux ensure TERM=screen-256color or xterm-256color."
    },
    {
      "issue": "Countdown refreshing too slowly or appearing static",
      "solution": "Decrease refreshInterval to 1000ms (1 second) in configuration. Verify script executes on each refresh. Check system clock accurate: date. Test manual execution shows changing countdown."
    }
  ],
  "documentationUrl": "https://docs.claude.com/en/docs/claude-code/statusline",
  "source": "community",
  "discoveryMetadata": {
    "researchDate": "2025-10-23",
    "trendingSources": [
      {
        "source": "claude_code_docs",
        "evidence": "Official docs mention block timer as key feature for monitoring Claude's 5-hour conversation blocks with visual indicators",
        "url": "https://docs.claude.com/en/docs/claude-code/statusline",
        "relevanceScore": "high"
      },
      {
        "source": "github_trending",
        "evidence": "ccstatusline and claude-statusline repos list block timer monitoring as core functionality",
        "url": "https://github.com/sirmalloc/ccstatusline",
        "relevanceScore": "high"
      },
      {
        "source": "community_feedback",
        "evidence": "Users frequently request countdown feature to avoid losing context during 5-hour limit expiration",
        "url": "https://github.com/anthropics/claude-code/issues/5404",
        "relevanceScore": "high"
      }
    ],
    "keywordResearch": {
      "primaryKeywords": [
        "session block timer",
        "5-hour limit tracker",
        "conversation block monitor",
        "Claude time remaining"
      ],
      "searchVolume": "high",
      "competitionLevel": "low"
    },
    "gapAnalysis": {
      "existingContent": ["session-timer-statusline"],
      "identifiedGap": "Existing session-timer shows elapsed time but not remaining time in the 5-hour block. No countdown timer, no visual progress bar, no expiration warnings. Users need proactive alerts to prevent losing context when block expires unexpectedly. Critical UX gap for production Claude Code usage.",
      "priority": "high"
    },
    "approvalRationale": "Block timer monitoring cited in official Claude Code docs and trending GitHub repos as essential feature. High search volume, low competition. Clear gap vs elapsed-time-only statusline. User approved for addressing critical session management need."
  }
}
