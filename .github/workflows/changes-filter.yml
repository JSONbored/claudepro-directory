name: Changes Filter (Reusable)

on:
  workflow_call:
    outputs:
      code:
        description: 'Code changes present'
        value: ${{ jobs.filter.outputs.code }}
      deps:
        description: 'Dependency changes present'
        value: ${{ jobs.filter.outputs.deps }}

jobs:
  filter:
    name: Detect Changes
    runs-on: ubuntu-latest
    timeout-minutes: 5
    outputs:
      code: ${{ steps.filter.outputs.code }}
      deps: ${{ steps.filter.outputs.deps }}

    steps:
      - uses: actions/checkout@v5

      - name: Check changed files
        id: filter
        uses: dorny/paths-filter@v3
        with:
          filters: |
            code:
              - 'src/**/*.{ts,tsx,js,jsx}'
              - 'scripts/**'
              - 'config/**'
              - 'supabase/functions/**/*.ts'
              - 'supabase/**/*.sql'
              - 'next.config.mjs'
              - 'tailwind.config.ts'
            deps:
              - 'package.json'
              - 'pnpm-lock.yaml'
